<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Proto DB</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="static/css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="white"/>

    <link rel="icon" href="static/images/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="static/images/protodb-icon-152.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Proto DB">
    <meta name="msapplication-TileImage" content="static/images/protodb-icon-144.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">

    <script defer src="static/js/idb-keyval-iife.js"></script>
    <script defer src="static/js/knockout-3.5.1.js"></script>
    <script defer src="static/js/protodb_util.js"></script>
    <script defer src="static/js/protodb_db.js"></script>
    <script defer src="static/js/protodb_ko_person.js"></script>
    <script defer src="static/js/protodb_ko_group.js"></script>
    <script defer src="static/js/protodb_ko_viewmodel.js"></script>
    <script defer src="static/js/protodb_formload.js"></script>
    <script defer src="static/js/protodb_tosheet.js"></script>
    <script defer src="static/js/protodb.js"></script>
</head>

<body>
    <div class="content">

<div class="both sendwarn" data-bind="visible: $root.sendworking()">
    <h1>SENDING DATA. DO NOT CLOSE WINDOW!</h1>
</div>
<div class="both" data-bind="visible: !$root.sendworking()">
    Sample data is being sent to <a href="https://docs.google.com/spreadsheets/d/1q_ibSJT3dKEmOnoQ0Dwy28PuAYQG6XXL-2KjfAC_m5U">spreadsheet</a>.
</div>

<div id="ls">
    <a href="admin.html">admin</a>

    <div data-bind="visible: !$root.showgroupsession()">
    <h1>People <button onclick="shownewperson()"
                    data-bind="visible: !$root.shownewgroup()">Add New Person</button>
                <button onclick="shownewperson(); return false;"
                    data-bind="visible: $root.shownewperson()">Cancel</button>
                    </h1>

    <form id="newperson" data-bind="visible: $root.shownewperson()"
            onsubmit="newperson(); return false;">

        <div id="newperson_questions">
        <!-- Generated on load by load_questions() -->
        </div>

        <input type="hidden" id="xpersonid" value="0" />

        <div class="qdiv">
        <input data-bind="visible: !$root.personexists()"
            type="submit" value="Create" />
        <button data-bind="visible: $root.personexists()" onclick="saveperson(); return false;">Save</button>
        <button onclick="shownewperson(); return false;">Cancel</button>
        </div>
    </form>

    <table>
    <thead><tr>
        <th data-bind="visible: $root.showpersoncheckboxes()">
            <span data-bind="click: function(){ $root.checkuncheck(); $root.setchange()}" title="Check/Uncheck All">x</span></th>
        <th>ID</th>
        <th>First name</th>
        <th>Last name</th>
        <th>Last initial</th>
        <th>Grade</th>
    </tr></thead>
    <tbody data-bind="foreach: people_byfl">
        <tr>
        <td data-bind="visible: $root.showpersoncheckboxes()"><input type="checkbox" data-bind="click: $root.setchange, attr: {id: 'ngpid'+pid()}" /></td>
        <td data-bind="text: pid(), click: checkorshowperson" class="num"></td>
        <td data-bind="text: fname(), click: checkorshowperson"></td>
        <td data-bind="text: lname(), click: checkorshowperson"></td>
        <td data-bind="text: linitial(), click: checkorshowperson"></td>
        <td data-bind="text: grade(), click: checkorshowperson"></td>
        </tr>
    </tbody>
    </table>
    </div>

    <div data-bind="visible: $root.showgroupsession()">
    <h1>People in Session
        <button data-bind="click: $root.cancelgroupsession">Cancel</button>
        </h1>
    <h3 data-bind="visible: !$root.quickgroup()">UNCHECK ABSENT STUDENTS!</h3>
    <h5 data-bind="visible: !$root.quickgroup()">(will not remove from group <span data-bind="text: selectedgroupname()"></span>, only from this session)</h5>
    <h5 data-bind="visible: $root.quickgroup()">Select Session Members Below</h5>
    <h5 data-bind="visible: $root.quickgroup()">Then Complete Session Details on Right Side</h5>
    <table>
    <thead><tr>
        <th><span data-bind="click: $root.checkuncheck" title="Check/Uncheck All">x</span></th>
        <th>ID</th>
        <th>First name</th>
        <th>Last name</th>
        <th>Last initial</th>
    </tr></thead>
    <tbody data-bind="foreach: group_people_byfl">
        <tr>
        <td><input type="checkbox" data-bind="attr: {id: 'gspid'+pid()}" /></td>
        <td data-bind="text: pid(), click: checkorshowperson" class="num"></td>
        <td data-bind="text: fname(), click: checkorshowperson"></td>
        <td data-bind="text: lname(), click: checkorshowperson"></td>
        <td data-bind="text: linitial(), click: checkorshowperson"></td>
        </tr>
    </tbody>
    </table>
    </div>

</div>

<div id="rs">
    <h1>Staff <button onclick="showeditstaff()">Edit</button>
        <button data-bind="visible: $root.showeditstaff()" onclick="showeditstaff()">Cancel</button></h1>

    <div id="staffdata" data-bind="visible: !$root.showeditstaff()">
        <h2 data-bind="text: staffname()"></h2>
        <h3 data-bind="text: positionname()"></h3>
    </div>

    <form id="editstaff" data-bind="visible: $root.showeditstaff()"
        onsubmit="editstaff(); return false;">
        <div id="newstaff_questions">
        <!-- Generated on load by load_session_questions() in protodb_formload.js -->
        </div>

        <div class="qdiv">
            <input type="submit" value="Save"/>
            <button onclick="showeditstaff(); return false;">Cancel</button>
        </div>
    </form>

    <div data-bind="visible: !$root.showgroupsession()">
    <h1>Groups
        <button onclick="shownewgroup()"
            data-bind="visible: !$root.shownewperson()">Add New Group</button>
        <button onclick="quicksession()"
            data-bind="visible: !$root.shownewperson() && !$root.shownewgroup()">Quick Session</button>
        <button onclick="shownewgroup(); return false;"
            data-bind="visible: $root.shownewgroup()">Cancel</button>
        </h1>

    <h5 data-bind="visible: !$root.shownewperson() && !$root.shownewgroup()">Click on Group name to view/edit members or create sessions</h5>

    <form id="newgroup" data-bind="visible: $root.shownewgroup()"
            onsubmit="newgroup(); return false;">

        <div class="qdiv qdivreq">
            <div>Group name</div>
            <div id="gname_err"></div>
            <input id="gname" type="text" required="required" />
        </div>

        <div class="qdiv">
            <div>Select Group Members on Left Side</div>
        </div>

        <div class="qdiv">
            <input type="submit" value="create"/>
            <button onclick="shownewgroup(); return false;">Cancel</button>
        </div>
    </form>

    <table>
    <thead><tr>
        <th>ID</th>
        <th>Name</th>
        <th data-bind="visible: $root.updategroup()"></th>
        <th data-bind="visible: $root.selectedgroup() && !$root.updategroup()"></th>
    </tr></thead>
    <tbody data-bind="foreach: groups_byname">
        <tr data-bind="css: {gsel: $root.selectedgroup()==$data}">
        <td data-bind="text: gid(), click: showgroup" class="num"></td>
        <td data-bind="text: name(), click: showgroup"></td>
        <td data-bind="visible: updategroup()">
            <button data-bind="click: savegroup">Save</button>
            <button data-bind="click: savecancel">Cancel</button></td>
        <td data-bind="visible: $root.selectedgroup()==$data && !$root.updategroup()">
            <button data-bind="click: newgroupsession">New Session</button>
            <button data-bind="click: savecancel">Cancel</button></td>
        <td data-bind="visible: $root.selectedgroup()==$data && !$root.updategroup()">(Or Select/Deselect People and Save)</td>
        </tr>
    </tbody>
    </table>
    </div>

    <div data-bind="visible: $root.showgroupsession()">
    <h1>Session for group <span data-bind="text: selectedgroupname()"></span>
        <button data-bind="click: $root.cancelgroupsession">Cancel</button>
    </h1>

    <h3 data-bind="visible: !$root.quickgroup()">UNCHECK ABSENT STUDENTS!</h3>
    <h5 data-bind="visible: !$root.quickgroup()">(will not remove from group <span data-bind="text: selectedgroupname()"></span>, only from this session)</h5>

    <form id="newsession"  onsubmit="return chkcreatesession();">
        <div class="qdiv qdivreq" id="session_members_reminder">Select Session Members on Left Side<br/>Uncheck Absent Students</div>

        <div id="newsession_questions">
        <!-- Generated on load by load_session_questions() -->
        </div>

        <div class="qdiv">
        <div>Please remember to uncheck absent students!</div>
        <input type="submit" value="Create" />
        <button data-bind="click: $root.cancelgroupsession">Cancel</button>
        </div>
    </form>

    </div>

</div>
    </div>

    <script src="static/js/main.js"></script>
</body>
</html>
